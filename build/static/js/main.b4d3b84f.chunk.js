(this["webpackJsonpqueue-system-frontend"]=this["webpackJsonpqueue-system-frontend"]||[]).push([[0],{13:function(e,t,s){"use strict";s.r(t);var r=s(0),i=s.n(r),n=s(3),u=s.n(n);s(2);const c=Object.freeze(["Bakery","Butcher","Fishmonger","Deli","Checkout"]);class a{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.user=e,this.tickets=[],this.queue=t,this.history=[],this.sections=c.reduce((e,t)=>(e[t]=1,e),{})}static loadQueueSystem(e){const t=JSON.parse(e),s=new a(t.user||"");return s.queue=(t.queue||[]).filter(e=>e.user&&e.ticket&&e.section),s.tickets=t.tickets||[],s.history=(t.history||[]).filter(e=>e.user&&e.ticket),s.sections=c.reduce((e,s)=>{var r;return e[s]=(null===(r=t.sections)||void 0===r?void 0:r[s])||1,e},{}),s}backedUpQueue(){return{user:this.user,queue:this.queue.filter(e=>e.user&&e.ticket&&e.section),tickets:this.tickets,history:this.history.filter(e=>e.user&&e.ticket),sections:c.reduce((e,t)=>(e[t]=this.sections[t]||1,e),{})}}requestTicket(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.user)throw new Error("User name is required to request a ticket");const s=this.sections[e]++,r={user:this.user,ticket:s,section:e,priority:t};this.queue.push(r);const i=this.queue.filter(t=>t.section===e).length;return`${t?"Priority":""} Ticket requested for ${this.user}, position ${i}`}showQueue(e){return this.queue.filter(t=>t.section===e)}averageWaitTimeForAll(){const e=c.reduce((e,t)=>(e[t]=0,e),{}),t=c.reduce((e,t)=>(e[t]=0,e),{});this.queue.forEach(s=>{const{section:r}=s,i=this.queue.filter(e=>e.section===r).indexOf(s)+1;e[r]+=i,t[r]++});return{...c.reduce((s,r)=>(s[r]=e[r]/t[r],s),{})}}callNextTicket(e){const t=this.queue.filter(t=>t.section===e);if(0===t.length)throw new Error(`There are no tickets in the ${e} queue`);const s=t.findIndex(e=>e.priority),r=-1===s?t[0]:t[s];return this.queue=this.queue.filter(e=>e!==r),this.history.push(r),`Next ticket for ${e} is ${r.ticket} for ${r.user}`}showLastCalledTickets(){return this.history?this.history.slice(Math.max(this.history.length-10,0)):"No tickets have been called yet"}emptyQueue(){this.queue=[],this.history=[],this.tickets=[],this.sections=c.reduce((e,t)=>(e[t]=1,e),{}),this.user=""}static loadQueue(e){if(!e)return new a;const t=JSON.parse(e),s=new a(t.user||"");return s.queue=(t.queue||[]).filter(e=>e.user&&e.ticket&&e.section),s.tickets=t.tickets||[],s.history=(t.history||[]).filter(e=>e.user&&e.ticket),s.sections=c.reduce((e,s)=>{var r;return e[s]=(null===(r=t.sections)||void 0===r?void 0:r[s])||1,e},{}),s}}function o(e){if(!e)return;const t=e.backedUpQueue();t.lastCalledTickets=e.showLastCalledTickets,localStorage.setItem("queueData",JSON.stringify(t))}function l(e){return`Name: ${e.user}\nTicket: ${e.ticket}\nPriority: ${e.priority?"Yes":"No"}\n----------------------`}var h=function(){const[e,t]=Object(r.useState)(""),[s,n]=Object(r.useState)(""),[u,h]=Object(r.useState)(""),[m]=Object(r.useState)(()=>function(){const e=localStorage.getItem("queueData");return e?a.loadQueueSystem(e):new a("")}()),[k,d]=Object(r.useState)(m.user||""),[f,p]=Object(r.useState)(m.queue),[y,q]=Object(r.useState)(m.lastCalledTickets||[]),[E,v]=Object(r.useState)("");Object(r.useEffect)(()=>{c.length>0&&(n(c[0]),h(c[0])),q(m.showLastCalledTickets())},[m]);const g=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!k)return void v("User name is required to request a ticket");m.user=k;const t=m.requestTicket(s,e);p([...m.queue]),v(t),o(m)};return i.a.createElement("div",{style:{display:"flex",justifyContent:"space-around"}},i.a.createElement("div",null,i.a.createElement("h2",null,"Client"),i.a.createElement("input",{type:"text",placeholder:"Enter your name",value:k,onChange:e=>d(e.target.value)}),i.a.createElement("select",{value:s,onChange:e=>n(e.target.value)},c.map(e=>i.a.createElement("option",{key:e,value:e},e))),i.a.createElement("button",{onClick:()=>g(!1)},"Request Ticket"),i.a.createElement("button",{onClick:()=>g(!0)},"Request Priority Ticket"),i.a.createElement("h3",null,"Queue for ",s),i.a.createElement("pre",null,f.filter(e=>e.section===s).map(l).join("\n\n"))),i.a.createElement("div",null,i.a.createElement("h2",null,"Customer"),i.a.createElement("select",{value:u,onChange:e=>h(e.target.value)},c.map(e=>i.a.createElement("option",{key:e,value:e},e))),i.a.createElement("button",{onClick:()=>{try{const e=m.callNextTicket(u);p([...m.queue]);const t=m.showLastCalledTickets();q(t),v(e),setTimeout(()=>{o(m)},0)}catch(e){v(e.message)}}},"Call Next Ticket"),i.a.createElement("button",{onClick:()=>{m.emptyQueue(),p([]),q([]),v("Queue has been emptied"),o(m)}},"Empty Queue"),i.a.createElement("p",null,E),i.a.createElement("h3",null,"Queue for ",u),i.a.createElement("pre",null,f.filter(e=>e.section===u).map(l).join("\n\n")),i.a.createElement("h3",null,"Last Called Tickets for ",u),i.a.createElement("pre",null,y.filter(e=>e.section===u).map(l).join("\n\n")),i.a.createElement("button",{onClick:()=>{const e=m.averageWaitTimeForAll();t("Average wait times for all sections: \n"+function(e){return Object.entries(e).map(e=>{let[t,s]=e;return`${t}: ${null===s||isNaN(s)?0:s} minutes`}).join("\n")}(e))}},"Average Wait Time"),i.a.createElement("pre",{style:{whiteSpace:"pre-wrap",wordWrap:"break-word",maxWidth:"350px"}},e)))};u.a.createRoot(document.getElementById("root")).render(i.a.createElement(h,null))},2:function(e,t,s){},4:function(e,t,s){e.exports=s(13)}},[[4,1,2]]]);
//# sourceMappingURL=main.b4d3b84f.chunk.js.map